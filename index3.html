<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connect 4</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f0f4ff;
    }

    header {
      background: #1c3faa;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .color-dot {
      display: inline-block;
      width: 16px;
      height: 16px;
      background: gray;
      border-radius: 50%;
      border: 2px solid #fff;
      margin-left: 6px;
      vertical-align: middle;
    }

    #playerInfo {
      font-size: 16px;
      font-weight: bold;
      display: flex;
      gap: 20px;
      align-items: center;
    }

    #turnDisplay {
      font-size: 14px;
      margin-top: 4px;
    }

    #aiToggle {
      margin-left: 20px;
      padding: 4px 8px;
      font-size: 14px;
    }

    main {
      display: flex;
      justify-content: center;
      padding: 20px;
    }

    #gameBoard {
      background: #005bb5;
      padding: 20px;
      border-radius: 15px;
      display: grid;
      grid-template-columns: repeat(7, 70px);
      grid-template-rows: repeat(6, 70px);
      gap: 10px;
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.25);
    }

    .cell {
      width: 70px;
      height: 70px;
      background: #87cefa;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.2s ease;
    }

    .piece {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      transition: transform 0.2s ease;
    }

    #resetBtn {
      margin-left: auto;
      padding: 8px 14px;
      font-size: 14px;
      color: #fff;
      background: #ff5733;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }

    #resetBtn:hover {
      background: #ff2e00;
    }

  </style>
</head>
<body>
<header>
  <div id="playerInfo">
    <div>
      Player 1: <span id="p1Name">Player 1</span>
      <span id="p1ColorDot" class="color-dot"></span>
    </div>
    <div>
      Player 2: <span id="p2Name">Player 2</span>
      <span id="p2ColorDot" class="color-dot"></span>
    </div>

    <!-- AI selection -->
    <select id="aiToggle">
      <option value="human">Player 2: Human</option>
      <option value="ai">Player 2: AI</option>
    </select>
  </div>

  <div id="turnDisplay">Turn: Player 1</div>
  <button id="resetBtn">Reset Game</button>
</header>

<main>
  <div id="gameBoard"></div>
</main>

<script>
  const ROWS = 6;
  const COLS = 7;
  let board = [];
  let currentPlayer = 1;
  let gameActive = true;

  const p1Color = "red";
  const p2Color = "yellow";

  document.getElementById("p1ColorDot").style.background = p1Color;
  document.getElementById("p2ColorDot").style.background = p2Color;

  const gameBoard = document.getElementById("gameBoard");
  const turnDisplay = document.getElementById("turnDisplay");
  const aiToggle = document.getElementById("aiToggle");

  function initBoard() {
    board = Array.from({ length: ROWS }, () => Array(COLS).fill(0));
    gameBoard.innerHTML = "";

    for (let r = 0; r < ROWS; r++) {
      for (let c = 0; c < COLS; c++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        cell.dataset.column = c;
        cell.addEventListener("click", () => handleColumnClick(c));
        gameBoard.appendChild(cell);
      }
    }
  }

  function handleColumnClick(col) {
    if (!gameActive) return;

    if (currentPlayer === 2 && aiToggle.value === "ai") return;

    dropPiece(col);
  }

  function dropPiece(col) {
    for (let row = ROWS - 1; row >= 0; row--) {
      if (board[row][col] === 0) {
        board[row][col] = currentPlayer;
        updateBoard();
        if (checkWin(currentPlayer)) {
          turnDisplay.textContent = `Player ${currentPlayer} Wins!`;
          gameActive = false;
          return;
        }
        switchTurn();
        return;
      }
    }
  }

  function switchTurn() {
    currentPlayer = currentPlayer === 1 ? 2 : 1;
    turnDisplay.textContent = `Turn: Player ${currentPlayer}`;

    if (currentPlayer === 2 && aiToggle.value === "ai") {
      setTimeout(aiMove, 400);
    }
  }

  function updateBoard() {
    const cells = document.querySelectorAll(".cell");

    let index = 0;
    for (let r = 0; r < ROWS; r++) {
      for (let c = 0; c < COLS; c++) {
        cells[index].innerHTML = "";
        if (board[r][c] !== 0) {
          const piece = document.createElement("div");
          piece.classList.add("piece");
          piece.style.background =
            board[r][c] === 1 ? p1Color : p2Color;
          cells[index].appendChild(piece);
        }
        index++;
      }
    }
  }

  function checkWin(player) {
    // Horizontal & Vertical
    for (let r = 0; r < ROWS; r++)
      for (let c = 0; c < COLS; c++)
        if (
          checkDir(r, c, 0, 1, player) ||
          checkDir(r, c, 1, 0, player) ||
          checkDir(r, c, 1, 1, player) ||
          checkDir(r, c, 1, -1, player)
        ) return true;
    return false;
  }

  function checkDir(r, c, dr, dc, player) {
    for (let i = 0; i < 4; i++) {
      const nr = r + dr * i;
      const nc = c + dc * i;
      if (nr < 0 || nr >= ROWS || nc < 0 || nc >= COLS) return false;
      if (board[nr][nc] !== player) return false;
    }
    return true;
  }

  // -----------------------------------------------------
  //                 SIMPLE AI LOGIC
  // -----------------------------------------------------
  function aiMove() {
    if (!gameActive) return;

    // 1. Try to win
    for (let col = 0; col < COLS; col++) {
      if (canDrop(col) && testMove(col, 2)) {
        dropPiece(col);
        return;
      }
    }

    // 2. Block player 1
    for (let col = 0; col < COLS; col++) {
      if (canDrop(col) && testMove(col, 1)) {
        dropPiece(col);
        return;
      }
    }

    // 3. Random valid column
    let valid = [];
    for (let c = 0; c < COLS; c++) if (canDrop(c)) valid.push(c);
    const rand = valid[Math.floor(Math.random() * valid.length)];
    dropPiece(rand);
  }

  function canDrop(col) {
    return board[0][col] === 0;
  }

  function testMove(col, player) {
    for (let row = ROWS - 1; row >= 0; row--) {
      if (board[row][col] === 0) {
        board[row][col] = player;
        const win = checkWin(player);
        board[row][col] = 0;
        return win;
      }
    }
    return false;
  }

  // Reset
  document.getElementById("resetBtn").onclick = () => {
    gameActive = true;
    currentPlayer = 1;
    turnDisplay.textContent = "Turn: Player 1";
    initBoard();
  };

  initBoard();
</script>

</body>
</html>
